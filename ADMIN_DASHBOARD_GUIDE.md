# 🎛️ دليل استخدام لوحة التحكم الإدارية - دلما

## 🌟 مرحباً بك في النظام الإداري الكامل!

تم بناء نظام إداري احترافي متكامل لإدارة تطبيق دلما. يتضمن النظام:

---

## 📦 ما تم إنجازه

### ✅ 1. Backend APIs (الخادم)
في ملف `dalma-api/index.js`:

#### 🔐 APIs الإدارة:
- `POST /admin/login` - تسجيل دخول المشرفين
- `GET /admin/stats` - الإحصائيات الشاملة
- `GET /admin/users` - جلب المستخدمين (مع بحث وفلترة)
- `PUT /admin/users/:id` - تعديل مستخدم
- `DELETE /admin/users/:id` - حذف مستخدم
- `GET /admin/media-requests` - جلب طلبات التحويل لإعلامي
- `PUT /admin/media-requests/:id` - قبول/رفض الطلبات
- `GET /admin/posts` - جلب المنشورات
- `PUT /admin/posts/:id` - اعتماد/إلغاء اعتماد منشور
- `DELETE /admin/posts/:id` - حذف منشور

#### 📱 APIs للمستخدمين (Flutter):
- `POST /api/media-request` - إرسال طلب التحويل لإعلامي
- `GET /api/media-request/status` - جلب حالة الطلب

#### 🗄️ جدول قاعدة البيانات الجديد:
```sql
CREATE TABLE media_requests (
  id SERIAL PRIMARY KEY,
  user_id INTEGER NOT NULL REFERENCES users(id) ON DELETE CASCADE,
  reason TEXT NOT NULL,
  portfolio_url TEXT,
  experience TEXT,
  status VARCHAR(20) DEFAULT 'pending',
  admin_notes TEXT,
  created_at TIMESTAMP DEFAULT NOW(),
  reviewed_at TIMESTAMP
);
```

---

### ✅ 2. لوحة التحكم Web Dashboard
في مجلد `dalma-admin/`:

#### 📄 الصفحات:
1. **`login.html`** - صفحة تسجيل الدخول
2. **`dashboard.html`** - الصفحة الرئيسية (إحصائيات)
3. **`users.html`** - إدارة المستخدمين
4. **`media-requests.html`** - طلبات الإعلاميين ⭐
5. **`posts.html`** - إدارة المنشورات
6. **`orders.html`** - إدارة الطلبات (قيد التطوير)

#### 🎨 الملفات المساعدة:
- `assets/css/admin.css` - التنسيقات
- `assets/js/admin.js` - الوظائف المشتركة
- `README.md` - دليل اللوحة

---

### ✅ 3. تطبيق Flutter
في مجلد `aldlma/lib/`:

#### 📱 الملفات الجديدة:
1. **`become_media_page.dart`** - صفحة طلب التحويل لإعلامي
2. **`media_request_service.dart`** - خدمات API للطلبات

#### 🔧 التعديلات:
- تم إضافة زر "طلب أن تصبح إعلامي" في صفحة `my_account_page.dart`
- الزر يظهر فقط للمستخدمين العاديين (ليس للإعلاميين أو مقدمي الخدمات)

---

## 🚀 كيفية الاستخدام

### 1️⃣ الوصول للوحة التحكم

افتح ملف `dalma-admin/login.html` في المتصفح:

```
file:///Users/kimaalanzi/Desktop/aaldma/dalma-admin/login.html
```

**أو** ارفع المجلد على استضافة ويب.

### 2️⃣ تسجيل الدخول

```
اسم المستخدم: admin
كلمة المرور: [محفوظة في ADMIN_PASSWORD]
```

> ⚠️ **مهم جداً:** غيّر كلمة المرور في Render Dashboard!

### 3️⃣ تغيير بيانات المشرف

في **Render Dashboard** → **Environment Variables**:

```
ADMIN_USERNAME=your_new_username
ADMIN_PASSWORD=your_strong_password
```

ثم اضغط **Save Changes** وانتظر إعادة التشغيل.

---

## 🎯 سيناريو الاستخدام الكامل

### من تطبيق Flutter:

1. **المستخدم يفتح صفحة "حسابي"**
2. **يضغط على زر "طلب أن تصبح إعلامي" 📢**
3. **يملأ الفورم:**
   - السبب (إجباري، 20 حرف على الأقل)
   - الخبرة (اختياري)
   - رابط الأعمال (اختياري)
4. **يرسل الطلب ✅**
5. **يستطيع مراجعة حالة الطلب في نفس الصفحة**

### من لوحة التحكم (Web):

1. **المشرف يسجل دخول**
2. **يرى في Dashboard عدد الطلبات المعلقة**
3. **يذهب لصفحة "طلبات الإعلاميين"**
4. **يفلتر بـ "قيد المراجعة"**
5. **يفتح الطلب ويراجع:**
   - اسم المستخدم
   - السبب
   - الخبرة
   - رابط الأعمال
6. **يضغط "مراجعة"**
7. **يختار "قبول" أو "رفض"**
8. **يكتب ملاحظات (اختياري)**
9. **يحفظ القرار ✅**

### ماذا يحدث عند القبول؟

- ✅ تحويل `role` المستخدم تلقائياً من `user` إلى `media`
- ✅ تفعيل جميع مميزات الإعلامي في التطبيق
- ✅ إرسال إشعار للمستخدم (المستقبل)

### ماذا يحدث عند الرفض؟

- ❌ الطلب يظل في قاعدة البيانات بحالة "مرفوض"
- ❌ المستخدم يستطيع رؤية سبب الرفض
- ℹ️ المستخدم يستطيع تقديم طلب جديد لاحقاً

---

## 🔒 الأمان

### ✅ تم تطبيق:
- JWT Token للمصادقة
- تشفير كلمة المرور (bcrypt)
- حماية جميع routes الإدارية
- Middleware للتحقق من صلاحية المشرف
- Rate Limiting للحماية من الهجمات

### ⚠️ توصيات:
1. **لا تشارك `ADMIN_USERNAME` و `ADMIN_PASSWORD` أبداً**
2. **استخدم HTTPS دائماً في الإنتاج**
3. **راجع الطلبات بعناية قبل القبول**
4. **احذف الطلبات القديمة دورياً**

---

## 🎨 التخصيص

### تغيير الألوان:
في `dalma-admin/assets/css/admin.css`:
```css
:root {
    --primary-color: #059669;  /* لون دلما الأخضر */
    --danger-color: #DC2626;
    /* ... */
}
```

### تغيير الشعار:
في جميع ملفات HTML:
```html
<h1>🌴 دلمــــا</h1>
```

### إضافة صفحات جديدة:
1. انسخ `dashboard.html` كقالب
2. عدّل المحتوى
3. أضف الـ route في `sidebar-nav`

---

## 🧪 الاختبار

### 1. اختبار من Flutter:

```bash
cd aldlma
flutter run
```

- سجل دخول كمستخدم عادي
- افتح "حسابي"
- اضغط "طلب أن تصبح إعلامي"
- املأ الفورم وأرسله

### 2. اختبار من Dashboard:

- افتح `login.html`
- سجل دخول
- اذهب لـ "طلبات الإعلاميين"
- راجع الطلب وقبله/ارفضه

### 3. اختبار التحول:

- ارجع لـ Flutter
- أعد تشغيل التطبيق (Hot Restart)
- الآن يجب أن تظهر صفحة الإعلامي!

---

## 📊 الإحصائيات المتاحة

في Dashboard:
- ✅ إجمالي المستخدمين
- ✅ عدد الإعلاميين
- ✅ عدد مقدمي الخدمات
- ✅ عدد المنشورات
- ✅ عدد الطلبات
- ⭐ عدد طلبات التحويل المعلقة

---

## 🐛 استكشاف الأخطاء

### خطأ: "Unauthorized"
**الحل:** سجل خروج وسجل دخول مرة أخرى.

### خطأ: "لا توجد بيانات"
**الحل:** تأكد أن السيرفر يعمل على Render.

### خطأ: "خطأ في إرسال الطلب"
**الحل:**
1. تحقق من الاتصال بالإنترنت
2. تحقق أن المستخدم مسجل دخول
3. افتح Console في Flutter للتفاصيل

---

## 📱 متوافق مع الأجهزة

### Web Dashboard:
- ✅ أجهزة الكمبيوتر
- ✅ الأجهزة اللوحية
- ✅ الهواتف (responsive)

### Flutter App:
- ✅ iOS
- ✅ Android
- ✅ Web (قيد الاختبار)

---

## 🎉 ما التالي؟

### قيد التطوير:
- [ ] نظام إشعارات Push للمستخدمين عند قبول/رفض الطلب
- [ ] إدارة الطلبات (Orders) الكاملة
- [ ] تقارير متقدمة وإحصائيات
- [ ] نظام تعليقات الإعلاميين
- [ ] API لحذف الطلبات القديمة تلقائياً

---

## 📞 الدعم

للمساعدة:
1. افتح Console (F12 للمتصفح)
2. افتح Terminal للـ Flutter
3. التقط screenshot للخطأ
4. شاهد Logs في Render Dashboard

---

## ✨ مميزات رائعة

- 🌐 واجهة عربية 100%
- 🎨 تصميم عصري ومميز
- 🚀 سريع وخفيف
- 📱 متجاوب مع جميع الأجهزة
- 🔒 آمن ومحمي
- 🛠️ سهل التخصيص
- 📊 إحصائيات فورية
- ⚡ بدون أطر عمل ثقيلة (Pure HTML/CSS/JS)

---

## 🙏 ملاحظات ختامية

تم بناء هذا النظام بعناية فائقة ليكون:
- **احترافي** - جاهز للإنتاج
- **آمن** - محمي بالكامل
- **سهل الاستخدام** - واجهة بديهية
- **قابل للتوسع** - يمكن إضافة مميزات بسهولة

**استمتع بالنظام!** 🚀🌴

---

© 2025 دلما - نظام إداري احترافي

