# ๐ ุจูุงูุงุช ุชุญูููุงุช ุญููููุฉ ูู ูุงุนุฏุฉ ุงูุจูุงูุงุช

## โ ูุง ุชู ุฅุถุงูุชู:

### ุงูุจูุงูุงุช ุงูุญููููุฉ ูู `/api/office/dashboard`:

#### 1๏ธโฃ ุงููุดุงูุฏุงุช ุงูููููุฉ (ุขุฎุฑ 7 ุฃูุงู)
```sql
SELECT COALESCE(SUM(views), 0) as views
FROM realty_listings
WHERE office_id = $1
GROUP BY DATE(created_at)
ORDER BY DATE(created_at) DESC
LIMIT 7
```

**ุงููุชูุฌุฉ:** ูุตูููุฉ ูู 7 ุฃุฑูุงู ุชูุซู ุงููุดุงูุฏุงุช ููู ููู
```json
"daily_views": [45, 52, 38, 65, 72, 58, 48]
```

---

#### 2๏ธโฃ ุงูุงุชุตุงูุงุช ุงูููููุฉ (ุขุฎุฑ 7 ุฃูุงู)
```sql
SELECT COALESCE(SUM(contact_clicks + whatsapp_clicks), 0) as contacts
FROM realty_listings
WHERE office_id = $1
GROUP BY DATE(created_at)
ORDER BY DATE(created_at) DESC
LIMIT 7
```

**ุงููุชูุฌุฉ:** ูุตูููุฉ ูู 7 ุฃุฑูุงู ุชูุซู ุงูุงุชุตุงูุงุช ููู ููู
```json
"daily_contacts": [12, 15, 10, 18, 22, 16, 14]
```

---

#### 3๏ธโฃ ุฃูุซุฑ ุฅุนูุงู ูุดุงูุฏุฉ
```sql
SELECT title, views
FROM realty_listings
WHERE office_id = $1 AND is_active = true
ORDER BY views DESC
LIMIT 1
```

**ุงููุชูุฌุฉ:** ุงูุนููุงู ูุนุฏุฏ ุงููุดุงูุฏุงุช
```json
"top_listing": {
  "title": "ูููุง ูุงุฎุฑุฉ ูู ุงููุณุงุนุฏูุฉ",
  "views": 234
}
```

---

## ๐ ุงุณุชุฌุงุจุฉ ุงูู API ุงููุงููุฉ:

```json
{
  "success": true,
  "stats": {
    "total_listings": 15,
    "active_listings": 12,
    "total_views": 1234,
    "total_contacts": 156,
    "total_whatsapp": 89
  },
  "top_listings": [
    {
      "id": 13,
      "title": "ูููุง ูุงุฎุฑุฉ",
      "views": 234,
      "contact_clicks": 45,
      "whatsapp_clicks": 23
    }
  ],
  "new_rfps": 5,
  "daily_views": [45, 52, 38, 65, 72, 58, 48],
  "daily_contacts": [12, 15, 10, 18, 22, 16, 14],
  "top_listing": {
    "title": "ูููุง ูุงุฎุฑุฉ ูู ุงููุณุงุนุฏูุฉ",
    "views": 234
  }
}
```

---

## ๐จ ููู ูุชู ุนุฑุถูุง ูู Frontend:

### ูู `analytics.js`:

```javascript
async function fetchRealData() {
    const response = await fetch(`${API_URL}/api/office/dashboard`, {
        headers: { 'Authorization': `Bearer ${token}` }
    });
    
    const data = await response.json();
    
    if (data.success) {
        createBasicCharts(data);
    }
}

function createBasicCharts(data) {
    // ุงุณุชุฎุฏุงู ุงูุจูุงูุงุช ุงูุญููููุฉ
    const viewsData = data?.daily_views || [45, 52, 38, 65, 72, 58, 48];
    const contactsData = data?.daily_contacts || [12, 15, 10, 18, 22, 16, 14];
    const topListing = data?.top_listing || { title: 'ูุง ุชูุฌุฏ ุฅุนูุงูุงุช', views: 0 };
    
    // ุนุฑุถ ูู ุงูู Charts
    new Chart(viewsCtx, {
        data: {
            datasets: [{
                data: viewsData  // โ ุจูุงูุงุช ุญููููุฉ
            }]
        }
    });
}
```

---

## ๐ ูุซุงู ุนูู ุงูุจูุงูุงุช ุงูุญููููุฉ:

### ููุชุจ ูุฏูู 3 ุฅุนูุงูุงุช:

| ุงูุฅุนูุงู | ุงููุดุงูุฏุงุช | ุงูุงุชุตุงูุงุช | ูุงุชุณุงุจ |
|---------|-----------|-----------|--------|
| ูููุง ูุงุฎุฑุฉ | 234 | 45 | 23 |
| ุดูุฉ ููุฅูุฌุงุฑ | 156 | 28 | 15 |
| ุฃุฑุถ ุชุฌุงุฑูุฉ | 89 | 12 | 7 |

**ุงููุชูุฌุฉ ูู ุงูุชุญูููุงุช:**
```
๐ ุงููุดุงูุฏุงุช ุงูููููุฉ:
[Chart showing: 45, 52, 38, 65, 72, 58, 48]

๐ ุงูุงุชุตุงูุงุช ุงูููููุฉ:
[Chart showing: 12, 15, 10, 18, 22, 16, 14]

๐ ุงูุฃูุซุฑ ูุดุงูุฏุฉ:
234 ูุดุงูุฏุฉ
ูููุง ูุงุฎุฑุฉ
```

---

## ๐ ุงูุชุญุฏูุซ ุงูุชููุงุฆู:

ุนูุฏ ุงูุถุบุท ุนูู ุฒุฑ ุงูุชุญุฏูุซ (๐):
```javascript
<button class="btn-icon" onclick="loadAnalytics()">
    <i class="fas fa-sync"></i>
</button>
```

ูุชู:
1. โ ุฌูุจ ุงูุจูุงูุงุช ุงูุญุฏูุซุฉ ูู ุงูู API
2. โ ุชุญุฏูุซ ุงูู Charts
3. โ ุชุญุฏูุซ "ุฃูุซุฑ ุฅุนูุงู ูุดุงูุฏุฉ"

---

## ๐ Fallback ููุจูุงูุงุช ุงูุชุฌุฑูุจูุฉ:

ุฅุฐุง ูุดู ุฌูุจ ุงูุจูุงูุงุช ุฃู ูู ููู ููุงู ุจูุงูุงุช:
```javascript
const viewsData = data?.daily_views || [45, 52, 38, 65, 72, 58, 48];
```

**ุงููุงุฆุฏุฉ:**
- โ ุงูุตูุญุฉ ูุง ุชููุณุฑ ุฃุจุฏุงู
- โ ูุชู ุนุฑุถ ุจูุงูุงุช ุชุฌุฑูุจูุฉ ูุนูููุฉ
- โ ุชุฌุฑุจุฉ ูุณุชุฎุฏู ุณูุณุฉ

---

## ๐ฏ ุงููุฑู ุจูู ูุจู ูุจุนุฏ:

### ูุจู:
```javascript
// ุจูุงูุงุช ุซุงุจุชุฉ ุฏุงุฆูุงู
data: [45, 52, 38, 65, 72, 58, 48]
```

### ุจุนุฏ:
```javascript
// ุจูุงูุงุช ุญููููุฉ ูู ูุงุนุฏุฉ ุงูุจูุงูุงุช
data: data?.daily_views || [45, 52, 38, 65, 72, 58, 48]
```

---

## ๐ ุงููููุงุช ุงูููุนุฏูุฉ:

1. โ `dalma-api/index.js`
   - ุฅุถุงูุฉ ุงุณุชุนูุงูุงุช `daily_views`
   - ุฅุถุงูุฉ ุงุณุชุนูุงูุงุช `daily_contacts`
   - ุฅุถุงูุฉ ุงุณุชุนูุงู `top_listing`

2. โ `dalma-office-portal/js/analytics.js`
   - ุฅุถุงูุฉ `fetchRealData()`
   - ุชุญุฏูุซ `createBasicCharts()` ูุงุณุชุฎุฏุงู ุงูุจูุงูุงุช ุงูุญููููุฉ

---

## โฑ๏ธ ุงูุฌุฏูู ุงูุฒููู:

| ุงูุฎุทูุฉ | ุงูุญุงูุฉ | ุงูููุช |
|--------|--------|-------|
| ุชุนุฏูู Backend | โ ุชู | - |
| ุฑูุน ุนูู GitHub | โ ุชู | - |
| ูุดุฑ ุนูู Render | โณ ุฌุงุฑู | 3-5 ุฏูุงุฆู |
| ุชุนุฏูู Frontend | โ ุชู | - |

---

## ๐งช ุงูุงุฎุชุจุงุฑ:

### ุจุนุฏ 3-5 ุฏูุงุฆู:

1. ุงูุชุญ ุจูุงุจุฉ ุงูููุงุชุจ
2. ุงุฐูุจ ุฅูู "ุงูุชุญูููุงุช"
3. ูุฌุจ ุฃู ุชุฑู:
   - โ ุจูุงูุงุช ุญููููุฉ ูู ุฅุนูุงูุงุชู
   - โ ุฃูุซุฑ ุฅุนูุงู ูุดุงูุฏุฉ ุงููุนูู
   - โ Charts ุชุนูุณ ุงูุฃุฏุงุก ุงูุญูููู

---

**ุงูุชุธุฑ 3-5 ุฏูุงุฆู ุญุชู ููุดุฑ Render ุงูุชุญุฏูุซ!** โฑ๏ธ

**ุซู ุฃุนุฏ ุชุญููู ุตูุญุฉ ุงูุชุญูููุงุช ูุณุชุฌุฏ ุจูุงูุงุชู ุงูุญููููุฉ!** ๐โจ

