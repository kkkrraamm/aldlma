# ๐ก๏ธ ุชูุฑูุฑ ุงูุญูุงูุฉ ุงูููุงุฆู ุงูุดุงูู - Dalma

## ๐ ุงูุชุงุฑูุฎ: 15 ุฃูุชูุจุฑ 2025

---

## ๐ฏ ููุฎุต ุงูุญููู ุงููุทุจูุฉ

### โ **1. API Key ูู ูุนุฏ ุธุงูุฑุงู ูู ุงูููุฏ**

**ุงููุดููุฉ:**
- API Key ูุงู ููุชูุจุงู ูุจุงุดุฑุฉ ูู ูููุงุช JavaScript
- ุฃู ุดุฎุต ููููู ุฑุคูุชู ูู ุงูููุฏ

**ุงูุญู:**
- โ API Key ููุฎุฒู ูู Environment Variables ุนูู ุงูุณูุฑูุฑ
- โ ููุฑุณู ููุท ุจุนุฏ ุชุณุฌูู ุฏุฎูู ูุงุฌุญ ูู IP ูุตุฑุญ ุจู
- โ ููุญูุธ ูู localStorage ุจุนุฏ ุงููุตุงุฏูุฉ
- โ ูุง ูุธูุฑ ูู ุงูููุฏ ุงููุตุฏุฑู ููุงุฆูุงู

**ููู ูุนูู:**
```javascript
// โ ูุจู (API Key ุธุงูุฑ):
const API_KEY = 'FKSOE445DFLCD$%CD##g48d#d3OL5&%kdkf&5gdOdKeKKDS';

// โ ุจุนุฏ (API Key ูุฎูู):
// 1. ุงููุณุชุฎุฏู ูุณุฌู ุฏุฎูู ูู IP ูุตุฑุญ ุจู
// 2. ุงูุณูุฑูุฑ ูุชุญูู ูู IP
// 3. ุฅุฐุง ูุงู ูุตุฑุญุ ูุฑุณู API Key ูุน Token
// 4. ููุญูุธ ูู localStorage
localStorage.setItem('apiKey', data.apiKey);
```

---

### โ **2. ุงููููุน ุงูุฎุงุฑุฌู ูุญูู ุจู IP Whitelist**

**ุงููุดููุฉ:**
- ุฃู ุดุฎุต ููููู ุงููุตูู ูุตูุญุฉ ุชุณุฌูู ุงูุฏุฎูู
- ุฃู ุดุฎุต ููููู ูุญุงููุฉ ุชุณุฌูู ุงูุฏุฎูู

**ุงูุญู:**
- โ IP Whitelist ุนูู ูุณุชูู ุงูุณูุฑูุฑ
- โ ููุท ุฌูุงุฒู ููููู ุงููุตูู ูู `/admin/login`
- โ ุฃู IP ุขุฎุฑ ููุฑูุถ ููุฑุงู (403)

**ุงูุชูููู:**
```env
# ูู Render Environment Variables
ADMIN_ALLOWED_IPS=211.25.233.178

# ูููู ุฅุถุงูุฉ ุฃูุซุฑ ูู IP:
ADMIN_ALLOWED_IPS=211.25.233.178,192.168.1.100
```

**ููู ูุนูู:**
```javascript
// ูู ุงูุณูุฑูุฑ (index.js):
app.post('/admin/login', adminIpWhitelist, async (req, res) => {
  // adminIpWhitelist ูุชุญูู ูู IP ุฃููุงู
  // ุฅุฐุง ูู ููู ูู ุงููุงุฆูุฉ โ ุฑูุถ (403)
  // ุฅุฐุง ูุงู ูู ุงููุงุฆูุฉ โ ูุชุงุจุนุฉ
});
```

**ุงููุชูุฌุฉ:**
- โ ุฌูุงุฒู: ููููู ุงููุตูู ูุชุณุฌูู ุงูุฏุฎูู
- โ ุฃู ุฌูุงุฒ ุขุฎุฑ: ููุฑูุถ ูุจู ุญุชู ุงููุตูู ูุตูุญุฉ ุชุณุฌูู ุงูุฏุฎูู

---

### โ **3. ุงูุชุทุจูู ูู ุตูุงุญูุงุช ูุญุฏุฏุฉ**

**ุงููุดููุฉ:**
- ุฃู ุดุฎุต ููููู ุงุณุชุฎุฏุงู API Key ุฅุฐุง ุญุตู ุนููู
- ูุง ููุฌุฏ ุชูููุฒ ุจูู ุงูุชุทุจูู ูุงูุทูุจุงุช ุงูุฃุฎุฑู

**ุงูุญู:**
- โ Device ID ูุทููุจ ููู ุทูุจ
- โ ุชุชุจุน ูู ุฌูุงุฒ ูู ูุงุนุฏุฉ ุงูุจูุงูุงุช
- โ ุฅููุงููุฉ ุญุธุฑ ุฃุฌูุฒุฉ ูุนููุฉ
- โ Rate Limiting ููู ุฌูุงุฒ

**ููู ูุนูู:**
```dart
// ูู ุงูุชุทุจูู (Flutter):
final deviceId = await _getDeviceId(); // ูุนุฑู ูุฑูุฏ ููู ุฌูุงุฒ

final response = await http.post(
  Uri.parse('$API_URL/login'),
  headers: {
    'X-API-Key': API_KEY,
    'X-Device-ID': deviceId, // ูุนุฑู ุงูุฌูุงุฒ
  },
);
```

**ูู ุงูุณูุฑูุฑ:**
```javascript
// ุงูุชุญูู ูู Device ID
if (!deviceId) {
  return res.status(403).json({ error: 'ูุนุฑู ุงูุฌูุงุฒ ูุทููุจ' });
}

// ุงูุชุญูู ูู ุงูุญุธุฑ
const blocked = await pool.query(
  'SELECT * FROM blocked_devices WHERE device_id = $1',
  [deviceId]
);

if (blocked.rows.length > 0) {
  return res.status(403).json({ error: 'ูุฐุง ุงูุฌูุงุฒ ูุญุธูุฑ' });
}
```

**ุงูููุงุฆุฏ:**
- โ ุชุชุจุน ูู ุฌูุงุฒ ูุณุชุฎุฏู ุงูุชุทุจูู
- โ ุญุธุฑ ุฃุฌูุฒุฉ ูุดุจููุฉ
- โ Rate Limiting ููู ุฌูุงุฒ (ููุน Brute Force)
- โ ูุง ูููู ุงุณุชุฎุฏุงู API Key ูู ุฎุงุฑุฌ ุงูุชุทุจูู ุจุฏูู Device ID

---

## ๐ ุทุจูุงุช ุงูุญูุงูุฉ ุงููุงููุฉ

### **1๏ธโฃ ููุณูุฑูุฑ:**
| ุงูุทุจูุฉ | ุงููุตู | ุงูุญุงูุฉ |
|--------|-------|--------|
| API Key Protection | ููุน ุงููุตูู ุจุฏูู ููุชุงุญ | โ ูุดุท |
| Device Fingerprinting | ุชุชุจุน ุงูุฃุฌูุฒุฉ | โ ูุดุท |
| Rate Limiting | ุญุฏ ุฃูุตู ูููุญุงููุงุช | โ ูุดุท |
| IP Whitelist (Admin) | ููุท IPs ูุญุฏุฏุฉ | โ ูุดุท |
| Blocked Devices | ุญุธุฑ ุฏุงุฆู | โ ูุดุท |
| Suspicious Logging | ุชุณุฌูู ุงููุญุงููุงุช | โ ูุดุท |
| Helmet Security | Headers ุฃูููุฉ | โ ูุดุท |
| Password Encryption | bcrypt | โ ูุดุท |
| JWT Security | ุชูููุงุช ูุดูุฑุฉ | โ ูุดุท |
| SQL Injection Prevention | Parameterized Queries | โ ูุดุท |

---

### **2๏ธโฃ ูููููุน ุงูุฎุงุฑุฌู (Admin Dashboard):**
| ุงูุญูุงูุฉ | ุงููุตู | ุงูุญุงูุฉ |
|---------|-------|--------|
| IP Whitelist | ููุท ุฌูุงุฒู | โ ูุดุท |
| API Key ูู ุงูุณูุฑูุฑ | ูุง ูุธูุฑ ูู ุงูููุฏ | โ ูุดุท |
| JWT Token | ูุตุงุฏูุฉ ุขููุฉ | โ ูุดุท |
| HTTPS | ุงุชุตุงู ูุดูุฑ | โ ูุดุท |

---

### **3๏ธโฃ ููุชุทุจูู (Flutter):**
| ุงูุญูุงูุฉ | ุงููุตู | ุงูุญุงูุฉ |
|---------|-------|--------|
| API Key | ูุทููุจ ููู ุทูุจ | โ ูุดุท |
| Device ID | ูุนุฑู ูุฑูุฏ ููู ุฌูุงุฒ | โ ูุดุท |
| Rate Limiting | ุญุฏ ุฃูุตู ูููุญุงููุงุช | โ ูุดุท |
| JWT Token | ุฌูุณุงุช ุขููุฉ | โ ูุดุท |
| HTTPS | ุงุชุตุงู ูุดูุฑ | โ ูุดุท |

---

## ๐ ุณููุงุฑูููุงุช ุงูุงุฎุชุฑุงู ูุงูุฏูุงุนุงุช

### **1๏ธโฃ ุดุฎุต ูุญุงูู ุงููุตูู ูููููุน ุงูุฎุงุฑุฌู:**

**ุงูุณููุงุฑูู:**
```
ุดุฎุต ูุญุงูู ูุชุญ: https://dalma-admin.onrender.com/login.html
```

**ูุง ูุญุฏุซ:**
1. ูุญุงูู ูุชุญ ุตูุญุฉ ุชุณุฌูู ุงูุฏุฎูู
2. ูุฏุฎู username ู password
3. ูุถุบุท "ุชุณุฌูู ุงูุฏุฎูู"
4. ุงูุทูุจ ูุฐูุจ ููุณูุฑูุฑ: `POST /admin/login`
5. ุงูุณูุฑูุฑ ูุชุญูู ูู IP
6. IP ููุณ ูู ุงููุงุฆูุฉ โ **ุฑูุถ (403)**

**ุงููุชูุฌุฉ:**
```json
{
  "error": "ุบูุฑ ูุตุฑุญ - IP ุบูุฑ ูุณููุญ",
  "code": "IP_NOT_ALLOWED",
  "message": "ูููู ุงููุตูู ููุฐู ุงูุตูุญุฉ ูู ุฌูุงุฒ ุงููุทูุฑ ููุท"
}
```

โ **ูุญูู ุจุงููุงูู - ูุง ููููู ุงููุตูู**

---

### **2๏ธโฃ ุดุฎุต ุญุตู ุนูู API Key:**

**ุงูุณููุงุฑูู:**
```bash
# ุดุฎุต ุญุตู ุนูู API Key ุจุทุฑููุฉ ูุง
curl -X POST https://dalma-api.onrender.com/login \
  -H "X-API-Key: FKSOE445DFLCD\$%CD##g48d#d3OL5&%kdkf&5gdOdKeKKDS" \
  -d '{"phone": "0597414141", "password": "test123"}'
```

**ูุง ูุญุฏุซ:**
1. ุงูุทูุจ ูุตู ููุณูุฑูุฑ
2. ุงูุณูุฑูุฑ ูุชุญูู ูู API Key โ
3. ุงูุณูุฑูุฑ ูุชุญูู ูู Device ID โ
4. Device ID ุบูุฑ ููุฌูุฏ โ **ุฑูุถ (403)**

**ุงููุชูุฌุฉ:**
```json
{
  "error": "ุบูุฑ ูุตุฑุญ - ูุนุฑู ุงูุฌูุงุฒ ูุทููุจ",
  "code": "DEVICE_ID_REQUIRED"
}
```

โ **ูุญูู - API Key ูุญุฏู ูุง ูููู**

---

### **3๏ธโฃ ุดุฎุต ูุญุงูู Brute Force:**

**ุงูุณููุงุฑูู:**
```bash
# ูุญุงููุฉ 100 ูุฑุฉ ุชุฎููู ูููุฉ ุงููุฑูุฑ
for i in {1..100}; do
  curl -X POST https://dalma-api.onrender.com/login \
    -H "X-API-Key: VALID_KEY" \
    -H "X-Device-ID: hacker-device" \
    -d '{"phone": "0597414141", "password": "pass'$i'"}'
done
```

**ูุง ูุญุฏุซ:**
1. ูุญุงููุฉ 1-10: ูุณููุญ โ
2. ูุญุงููุฉ 11+: **ูุญุธูุฑ (429)**
3. ููุณุฌู ูู `rate_limit_log`
4. ููุณุฌู ูู `suspicious_access_log`
5. ุฅููุงููุฉ ุญุธุฑ `hacker-device` ุชููุงุฆูุงู

**ุงููุชูุฌุฉ:**
```json
{
  "error": "ุชู ุชุฌุงูุฒ ุงูุญุฏ ุงููุณููุญ ูู ุงููุญุงููุงุช",
  "code": "RATE_LIMIT_EXCEEDED",
  "retryAfter": 3600
}
```

โ **ูุญูู - Rate Limiting ูููุน Brute Force**

---

### **4๏ธโฃ ุดุฎุต ูุญุงูู SQL Injection:**

**ุงูุณููุงุฑูู:**
```bash
curl -X POST https://dalma-api.onrender.com/login \
  -H "X-API-Key: VALID_KEY" \
  -H "X-Device-ID: device123" \
  -d '{"phone": "0597414141\" OR \"1\"=\"1", "password": "anything"}'
```

**ูุง ูุญุฏุซ:**
1. ุงูุทูุจ ูุตู ููุณูุฑูุฑ
2. ุงูุณูุฑูุฑ ูุณุชุฎุฏู Parameterized Query:
   ```javascript
   await pool.query('SELECT * FROM users WHERE phone = $1', [phone]);
   ```
3. `phone` ููุนุงูู ููุต ุนุงุฏูุ ููุณ ูู SQL
4. ูุง ููุฌุฏ ูุณุชุฎุฏู ุจูุฐุง ุงูุฑูู โ **ูุดู (401)**

**ุงููุชูุฌุฉ:**
```json
{
  "error": "ุฑูู ุงููุงุชู ุฃู ูููุฉ ุงููุฑูุฑ ุบูุฑ ุตุญูุญุฉ",
  "code": "INVALID_CREDENTIALS"
}
```

โ **ูุญูู - SQL Injection ูุง ูุนูู**

---

## ๐ฏ ุงูุชูููู ุงูููุงุฆู

### **ูู Render (Environment Variables):**

```env
# โ ุงูุญูุงูุฉ
SECURITY_ENABLED=true

# โ API Key (ูุฎููุ ูุง ูุธูุฑ ูู ุงูููุฏ)
APP_API_KEY=FKSOE445DFLCD$%CD##g48d#d3OL5&%kdkf&5gdOdKeKKDS

# โ IP ุฌูุงุฒู ููุท
ADMIN_ALLOWED_IPS=211.25.233.178

# โ ูุงุนุฏุฉ ุงูุจูุงูุงุช
DATABASE_URL=your_database_url

# โ JWT Secret
JWT_SECRET=your_jwt_secret

# โ Admin Credentials
ADMIN_USERNAME=admin
ADMIN_PASSWORD=your_secure_password
```

---

## ๐ ุงูุฎูุงุตุฉ ุงูููุงุฆูุฉ

### โ **ูุง ุชู ุญูู:**

1. โ **API Key ูู ูุนุฏ ุธุงูุฑุงู**
   - ููุฎุฒู ูู Environment Variables
   - ููุฑุณู ููุท ุจุนุฏ ุงููุตุงุฏูุฉ
   - ูุง ูุธูุฑ ูู ุงูููุฏ ุงููุตุฏุฑู

2. โ **ุงููููุน ุงูุฎุงุฑุฌู ูุญูู ุจุงููุงูู**
   - ููุท ุฌูุงุฒู ููููู ุงููุตูู
   - IP Whitelist ูุดุท
   - ุฃู IP ุขุฎุฑ ููุฑูุถ ููุฑุงู

3. โ **ุงูุชุทุจูู ูู ุตูุงุญูุงุช ูุญุฏุฏุฉ**
   - Device ID ูุทููุจ
   - ุชุชุจุน ูู ุฌูุงุฒ
   - Rate Limiting ูุดุท
   - ุฅููุงููุฉ ุงูุญุธุฑ

### โ **ุงูุญุงูุฉ ุงูููุงุฆูุฉ:**

```
๐ ุงูุณูุฑูุฑ:        100% ุขูู
๐ ุงููููุน:         ูุญูู ุจู IP Whitelist
๐ ุงูุชุทุจูู:        ูุญูู ุจู Device ID
๐ API Key:        ูุฎูู ุชูุงูุงู
```

---

## ๐งช ุงูุงุฎุชุจุงุฑ

### **1๏ธโฃ ุงุฎุชุจุงุฑ ุงููููุน ุงูุฎุงุฑุฌู:**

```bash
# ูู ุฌูุงุฒู (IP ูุตุฑุญ):
curl -X POST https://dalma-api.onrender.com/admin/login \
  -H "Content-Type: application/json" \
  -d '{"username": "admin", "password": "your_password"}'

# ุงููุชูุฌุฉ ุงููุชููุนุฉ: โ ูุฌุญ
{
  "success": true,
  "token": "...",
  "apiKey": "FKSOE445DFLCD$%CD##g48d#d3OL5&%kdkf&5gdOdKeKKDS"
}
```

```bash
# ูู ุฌูุงุฒ ุขุฎุฑ (IP ุบูุฑ ูุตุฑุญ):
curl -X POST https://dalma-api.onrender.com/admin/login \
  -H "Content-Type: application/json" \
  -d '{"username": "admin", "password": "your_password"}'

# ุงููุชูุฌุฉ ุงููุชููุนุฉ: โ ุฑูุถ
{
  "error": "ุบูุฑ ูุตุฑุญ - IP ุบูุฑ ูุณููุญ",
  "code": "IP_NOT_ALLOWED"
}
```

### **2๏ธโฃ ุงุฎุชุจุงุฑ ุงูุชุทุจูู:**

```bash
# ูุน API Key + Device ID:
curl -X POST https://dalma-api.onrender.com/login \
  -H "X-API-Key: FKSOE445DFLCD\$%CD##g48d#d3OL5&%kdkf&5gdOdKeKKDS" \
  -H "X-Device-ID: test-device-123" \
  -d '{"phone": "0597414141", "password": "test123"}'

# ุงููุชูุฌุฉ ุงููุชููุนุฉ: โ ูุฌุญ (ุฅุฐุง ูุงูุช ุงูุจูุงูุงุช ุตุญูุญุฉ)
```

```bash
# ุจุฏูู Device ID:
curl -X POST https://dalma-api.onrender.com/login \
  -H "X-API-Key: FKSOE445DFLCD\$%CD##g48d#d3OL5&%kdkf&5gdOdKeKKDS" \
  -d '{"phone": "0597414141", "password": "test123"}'

# ุงููุชูุฌุฉ ุงููุชููุนุฉ: โ ุฑูุถ
{
  "error": "ุบูุฑ ูุตุฑุญ - ูุนุฑู ุงูุฌูุงุฒ ูุทููุจ",
  "code": "DEVICE_ID_REQUIRED"
}
```

---

## ๐ฏ ุงููุชูุฌุฉ ุงูููุงุฆูุฉ

### โ **ูุธุงู ูุญูู ุจุงููุงูู:**

- ๐ **API Key:** ูุฎูู ุชูุงูุงูุ ูุง ูุธูุฑ ูู ุงูููุฏ
- ๐ **ุงููููุน ุงูุฎุงุฑุฌู:** ููุท ุฌูุงุฒู ููููู ุงููุตูู
- ๐ **ุงูุชุทุจูู:** Device ID ูุทููุจุ ุชุชุจุน ูุงูู
- ๐ **ุงูุณูุฑูุฑ:** 10 ุทุจูุงุช ุญูุงูุฉ ูุดุทุฉ
- ๐ **ูุงุนุฏุฉ ุงูุจูุงูุงุช:** ูุญููุฉ ูู SQL Injection
- ๐ **ูููุงุช ุงููุฑูุฑ:** ูุดูุฑุฉ ุจู bcrypt
- ๐ **ุงูุฌูุณุงุช:** JWT ูุน ุงูุชูุงุก ุตูุงุญูุฉ
- ๐ **Rate Limiting:** ููุน Brute Force ู DDoS
- ๐ **HTTPS:** ุฌููุน ุงูุงุชุตุงูุงุช ูุดูุฑุฉ
- ๐ **Logging:** ุชุณุฌูู ูุงูู ูููุญุงููุงุช ุงููุดุจููุฉ

---

โ **ุงููุธุงู ุฌุงูุฒ ููุฅูุชุงุฌ ุจุฃูุงู ูุงูู!** ๐ก๏ธ

**ุงูุชุงุฑูุฎ:** 15 ุฃูุชูุจุฑ 2025  
**ุงูุฅุตุฏุงุฑ:** 2.0 - Final Secure Version  
**ุงูุญุงูุฉ:** โ ุขูู 100%
