<!DOCTYPE html>
<html lang="ar" dir="rtl" data-theme="dark">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ุงูุฑูุงุจุฉ ุงููุงููุฉ - Dalma Admin Pro</title>
    
    <!-- Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Cairo:wght@300;400;600;700;900&display=swap" rel="stylesheet">
    
    <!-- Font Awesome -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    
    <!-- Main CSS -->
    <link rel="stylesheet" href="css/main.css">
    <link rel="stylesheet" href="css/unified-sidebar.css">
    <link rel="stylesheet" href="css/topbar.css">
    
    <!-- ApexCharts -->
    <script src="https://cdn.jsdelivr.net/npm/apexcharts@3.44.0/dist/apexcharts.min.js"></script>
</head>
<body>
    <!-- Sidebar -->
    <!-- Unified Sidebar -->
    <div id="sidebarContainer"></div>

    <!-- Main Content -->
    <main class="main-content">
        <!-- Header -->
        <header class="main-header">
            <div class="header-left">
                <button class="btn btn-icon" id="sidebarToggle">
                    <i class="fas fa-bars"></i>
                </button>
                <h1>๐ฐ ุงูุฑูุงุจุฉ ุงููุงููุฉ</h1>
            </div>
            <div class="header-right">
                <button class="btn btn-icon" id="themeToggle">
                    <i class="fas fa-moon"></i>
                </button>
                <div class="user-menu">
                    <span id="adminName">Admin</span>
                    <i class="fas fa-user-circle"></i>
                </div>
            </div>
        </header>

        <!-- Finance Dashboard -->
        <div class="finance-container">
            <!-- Stats Cards -->
            <div class="stats-grid">
                <div class="stat-card primary">
                    <div class="stat-icon">
                        <i class="fas fa-dollar-sign"></i>
                    </div>
                    <div class="stat-content">
                        <p class="stat-label">ุฅุฌูุงูู ุงูุชูุงููู (ุงูุดูุฑ)</p>
                        <h3 class="stat-value" id="totalCost">$0.00</h3>
                        <span class="stat-change positive">
                            <i class="fas fa-arrow-down"></i>
                            <span id="costChange">-12%</span>
                        </span>
                    </div>
                </div>

                <div class="stat-card success">
                    <div class="stat-icon">
                        <i class="fas fa-plug"></i>
                    </div>
                    <div class="stat-content">
                        <p class="stat-label">ุงุณุชุฏุนุงุกุงุช API</p>
                        <h3 class="stat-value" id="apiCalls">0</h3>
                        <span class="stat-change positive">
                            <i class="fas fa-arrow-up"></i>
                            <span id="callsChange">+8%</span>
                        </span>
                    </div>
                </div>

                <div class="stat-card warning">
                    <div class="stat-icon">
                        <i class="fas fa-robot"></i>
                    </div>
                    <div class="stat-content">
                        <p class="stat-label">ุชูููุฉ Dalma AI</p>
                        <h3 class="stat-value" id="aiCost">$0.00</h3>
                        <span class="stat-change negative">
                            <i class="fas fa-arrow-up"></i>
                            <span id="aiChange">+15%</span>
                        </span>
                    </div>
                </div>

                <div class="stat-card info">
                    <div class="stat-icon">
                        <i class="fas fa-database"></i>
                    </div>
                    <div class="stat-content">
                        <p class="stat-label">ุชูููุฉ Database</p>
                        <h3 class="stat-value" id="dbCost">$0.00</h3>
                        <span class="stat-change positive">
                            <i class="fas fa-arrow-down"></i>
                            <span id="dbChange">-5%</span>
                        </span>
                    </div>
                </div>
            </div>

            <!-- Charts Row 1 -->
            <div class="charts-row">
                <!-- Cost Trends Chart -->
                <div class="card chart-card">
                    <div class="card-header">
                        <h2 class="card-title">
                            <i class="fas fa-chart-line"></i>
                            ุงุชุฌุงูุงุช ุงูุชูุงููู
                        </h2>
                        <select onchange="changeCostPeriod(this.value)" class="period-select">
                            <option value="7d">ุขุฎุฑ 7 ุฃูุงู</option>
                            <option value="30d" selected>ุขุฎุฑ 30 ููู</option>
                            <option value="90d">ุขุฎุฑ 90 ููู</option>
                            <option value="1y">ุงูุณูุฉ ุงููุงุถูุฉ</option>
                        </select>
                    </div>
                    <div class="card-body">
                        <div id="costTrendsChart" style="min-height: 350px;"></div>
                    </div>
                </div>

                <!-- Cost Breakdown Chart -->
                <div class="card chart-card">
                    <div class="card-header">
                        <h2 class="card-title">
                            <i class="fas fa-chart-pie"></i>
                            ุชูุฒูุน ุงูุชูุงููู
                        </h2>
                    </div>
                    <div class="card-body">
                        <div id="costBreakdownChart" style="min-height: 350px;"></div>
                    </div>
                </div>
            </div>

            <!-- Detailed API Costs -->
            <div class="card">
                <div class="card-header">
                    <h2 class="card-title">
                        <i class="fas fa-code"></i>
                        ุชูุงููู API ุญุณุจ Endpoint
                    </h2>
                    <button class="btn btn-primary" onclick="exportApiCosts()">
                        <i class="fas fa-download"></i>
                        ุชุตุฏูุฑ
                    </button>
                </div>
                <div class="card-body">
                    <div class="table-responsive">
                        <table class="data-table">
                            <thead>
                                <tr>
                                    <th>Endpoint</th>
                                    <th>ุงูุงุณุชุฏุนุงุกุงุช</th>
                                    <th>ูุชูุณุท ุงูููุช</th>
                                    <th>ุงูุชูููุฉ/ุงุณุชุฏุนุงุก</th>
                                    <th>ุงูุฅุฌูุงูู</th>
                                    <th>ุงูุงุชุฌุงู</th>
                                </tr>
                            </thead>
                            <tbody id="apiCostsTable">
                                <!-- Will be populated by JS -->
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>

            <!-- Budget Alerts -->
            <div class="card">
                <div class="card-header">
                    <h2 class="card-title">
                        <i class="fas fa-bell"></i>
                        ุชูุจููุงุช ุงูููุฒุงููุฉ
                    </h2>
                    <button class="btn btn-outline" onclick="configureBudget()">
                        <i class="fas fa-cog"></i>
                        ุฅุนุฏุงุฏุงุช
                    </button>
                </div>
                <div class="card-body">
                    <div id="budgetAlerts">
                        <!-- Will be populated by JS -->
                    </div>
                </div>
            </div>

            <!-- Cost Predictions -->
            <div class="card">
                <div class="card-header">
                    <h2 class="card-title">
                        <i class="fas fa-crystal-ball"></i>
                        ุชููุนุงุช ุงูุชูุงููู (AI-Powered)
                    </h2>
                </div>
                <div class="card-body">
                    <div id="costPredictionsChart" style="min-height: 300px;"></div>
                    <div class="predictions-summary" id="predictionsSummary">
                        <!-- Will be populated by JS -->
                    </div>
                </div>
            </div>
        </div>
    </main>

    <!-- Budget Configuration Modal -->
    <div class="modal" id="budgetModal">
        <div class="modal-content">
            <div class="modal-header">
                <h2>
                    <i class="fas fa-cog"></i>
                    ุฅุนุฏุงุฏุงุช ุงูููุฒุงููุฉ
                </h2>
                <button class="btn btn-icon" onclick="closeBudgetModal()">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            <div class="modal-body">
                <div class="form-group">
                    <label for="monthlyBudget">ุงูููุฒุงููุฉ ุงูุดูุฑูุฉ ($)</label>
                    <input type="number" id="monthlyBudget" class="form-control" placeholder="5000">
                </div>
                <div class="form-group">
                    <label for="warningThreshold">ูุณุจุฉ ุงูุชุญุฐูุฑ (%)</label>
                    <input type="number" id="warningThreshold" class="form-control" value="80">
                </div>
                <div class="form-group">
                    <label for="criticalThreshold">ูุณุจุฉ ุญุฑุฌุฉ (%)</label>
                    <input type="number" id="criticalThreshold" class="form-control" value="95">
                </div>
                <div class="form-group">
                    <label>
                        <input type="checkbox" id="emailAlerts">
                        ุฅุฑุณุงู ุชูุจููุงุช ุงูุจุฑูุฏ ุงูุฅููุชุฑููู
                    </label>
                </div>
            </div>
            <div class="modal-footer">
                <button class="btn btn-outline" onclick="closeBudgetModal()">ุฅูุบุงุก</button>
                <button class="btn btn-primary" onclick="saveBudgetConfig()">
                    <i class="fas fa-save"></i>
                    ุญูุธ
                </button>
            </div>
        </div>
    </div>

    <!-- Scripts -->
    <script src="js/topbar.js"></script>
    <script src="js/sidebar.js"></script>
    <script src="js/main.js"></script>
    <script src="js/finance-monitoring.js"></script>
    
    <script>
        // Check authentication and initialize
        window.addEventListener('DOMContentLoaded', () => {
            const token = localStorage.getItem('admin_token');
            if (!token) {
                window.location.href = 'login.html';
                return;
            }
            
            renderTopBar('ุงููุงููุฉ');
        });
    </script>
</body>
</html>


