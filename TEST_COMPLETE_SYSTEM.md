# ๐งช ุงุฎุชุจุงุฑ ุงููุธุงู ุงููุงูู - ููุตุฉ ุงูุฏููุง ุงูุนูุงุฑูุฉ

## โ ูุงุฆูุฉ ุงูุชุญูู ุงูุดุงููุฉ

### 1๏ธโฃ **ูุงุนุฏุฉ ุงูุจูุงูุงุช (PostgreSQL)**

#### ุงูุฌุฏุงูู ุงููุทููุจุฉ (15 ุฌุฏูู):
- โ `realty_offices` - ุงูููุงุชุจ ุงูุนูุงุฑูุฉ
- โ `realty_office_users` - ูุณุชุฎุฏูู ุงูููุงุชุจ
- โ `realty_plans` - ุงูุจุงูุงุช
- โ `realty_subscriptions` - ุงูุงุดุชุฑุงูุงุช
- โ `realty_listings` - ุงูุนูุงุฑุงุช
- โ `realty_listing_images` - ุตูุฑ ุงูุนูุงุฑุงุช
- โ `realty_rfp_requests` - ุงูุทูุจุงุช ุงูุฎุงุตุฉ
- โ `realty_rfp_attachments` - ูุฑููุงุช ุงูุทูุจุงุช
- โ `realty_rfp_bids` - ุนุฑูุถ ุงูููุงุชุจ
- โ `realty_events` - ุงูุฃุญุฏุงุซ
- โ `realty_search_logs` - ุณุฌู ุงูุจุญุซ
- โ `realty_daily_office_metrics` - ููุงููุณ ุงูููุงุชุจ
- โ `realty_daily_listing_metrics` - ููุงููุณ ุงูุนูุงุฑุงุช
- โ `realty_market_trends` - ุงุชุฌุงูุงุช ุงูุณูู
- โ `realty_office_registration_requests` - ุทูุจุงุช ุงูุชุณุฌูู

#### ุงูุชุญูู ูู ุงูุฃุนูุฏุฉ:
```sql
-- realty_offices
โ id, name, city, phone, email
โ username (UNIQUE) - ููุฏุฎูู
โ password - ูุดูุฑ bcrypt
โ status (active, suspended, blocked)
โ last_login

-- realty_listings
โ id, office_id, title, type, status
โ city, district, lat, lng
โ price, area, rooms, bathrooms
โ is_active (BOOLEAN)
โ views, contact_clicks, whatsapp_clicks

-- realty_subscriptions
โ office_id, plan_id
โ start_date, end_date
โ status (active, grace, expired)
```

---

### 2๏ธโฃ **Backend APIs (27 Endpoint)**

#### ุงุฎุชุจุงุฑ ูู API:

**Authentication:**
```bash
# Login
curl -X POST https://dalma-api.onrender.com/api/office/login \
  -H "Content-Type: application/json" \
  -d '{"username":"OFF-XXX","password":"XXX"}'
```

**Listings:**
```bash
# Get Listings
curl https://dalma-api.onrender.com/api/office/listings \
  -H "Authorization: Bearer TOKEN"

# Add Listing
curl -X POST https://dalma-api.onrender.com/api/office/listings \
  -H "Authorization: Bearer TOKEN" \
  -H "Content-Type: application/json" \
  -d '{"title":"ุดูุฉ","type":"apartment","status":"for_sale",...}'
```

**RFP:**
```bash
# Get RFP Inbox
curl https://dalma-api.onrender.com/api/office/rfp/inbox \
  -H "Authorization: Bearer TOKEN"

# Send Bid
curl -X POST https://dalma-api.onrender.com/api/office/rfp/1/bid \
  -H "Authorization: Bearer TOKEN" \
  -d '{"message":"ุนุฑุถ","contact_phone":"05XXX"}'
```

**Admin:**
```bash
# Approve Request
curl -X POST https://dalma-api.onrender.com/api/admin/office-registration/1/approve \
  -H "Content-Type: application/json" \
  -d '{"review_notes":"ููุจูู"}'

# Get Offices
curl https://dalma-api.onrender.com/api/admin/offices
```

---

### 3๏ธโฃ **Office Portal (11 ุตูุญุฉ)**

#### ุงุฎุชุจุงุฑ ูู ุตูุญุฉ:

**1. index.html:**
- โ ูุชุญ ุงูุตูุญุฉ
- โ ุฅุฏุฎุงู ูุนุฑู ูุจุฏุฃ ุจู OFF-
- โ ุฅุฏุฎุงู ูููุฉ ูุฑูุฑ
- โ ุชุณุฌูู ุฏุฎูู ูุงุฌุญ
- โ ุญูุธ Token ูู localStorage
- โ ุชูุฌูู ูู dashboard

**2. dashboard.html:**
- โ ุนุฑุถ ุงูุฅุญุตุงุฆูุงุช
- โ ุฑุณู ุจูุงูู ูุนูู
- โ ุฃูุซุฑ ุงูุฅุนูุงูุงุช ูุฌุงุญุงู
- โ ุงูุฅุฌุฑุงุกุงุช ุงูุณุฑูุนุฉ
- โ ุงูุชูุจููุงุช

**3. listings.html:**
- โ ุนุฑุถ ุงูุนูุงุฑุงุช
- โ ุฒุฑ ุชุนุฏูู ูุนูู
- โ ุฒุฑ ุญุฐู ูุนูู
- โ ุงูุฅุญุตุงุฆูุงุช ุชุธูุฑ

**4. add-listing.html:**
- โ ุงููููุฐุฌ ูุนูู
- โ ุงูุฎุฑูุทุฉ ุชุธูุฑ
- โ ุชุญุฏูุฏ ุงููููุน ูุนูู
- โ ุฑูุน ุงูุตูุฑ ูุนูู
- โ ุงูุฅุฑุณุงู ูุงุฌุญ

**5. edit-listing.html:**
- โ ุชุญููู ุงูุจูุงูุงุช
- โ ุงูุชุนุฏูู ูุนูู
- โ ุชูุนูู/ุฅูุบุงุก ุชูุนูู

**6. rfp-inbox.html:**
- โ ุนุฑุถ ุงูุทูุจุงุช ุญุณุจ ุงูุจุงูุฉ
- โ ููู ููุจุงูุฉ ุงููุฌุงููุฉ
- โ ุฅุฑุณุงู ุนุฑุถ ูุนูู

**7. my-bids.html:**
- โ ุนุฑุถ ุงูุนุฑูุถ
- โ ุงูุฅุญุตุงุฆูุงุช
- โ ุชุชุจุน ุงูุญุงูุฉ

**8. subscription.html:**
- โ ุนุฑุถ ุงูุจุงูุฉ ุงูุญุงููุฉ
- โ ุงูุงุณุชุฎุฏุงู
- โ ุฌููุน ุงูุจุงูุงุช

**9. analytics.html:**
- โ ุงูุชุญูููุงุช ุงูุฃุณุงุณูุฉ
- โ ุงููููุฒุงุช ุงูููููุฉ
- โ Overlays ุชุนูู

**10. settings.html:**
- โ ุชุนุฏูู ุงููุนูููุงุช
- โ ุชุบููุฑ ูููุฉ ุงููุฑูุฑ
- โ ูุญุต ุงูููุฉ

**11. team.html:**
- โ ููู ููุจุงูุงุช ุงูุฃุณุงุณูุฉ
- โ ุจุงูุฑ ุงูุชุฑููุฉ

---

### 4๏ธโฃ **Admin Pro (4 ุตูุญุงุช)**

**1. office-registrations.html:**
- โ ุนุฑุถ ุงูุทูุจุงุช
- โ ูุจูู โ ุชูููุฏ ูุนุฑู
- โ ุนุฑุถ ุงูุจูุงูุงุช
- โ ูุณุฎ ููุญุงูุธุฉ

**2. offices-management.html:**
- โ ุนุฑุถ ุงูููุงุชุจ
- โ ุชุนููู ูุนูู
- โ ุชูุนูู ูุนูู
- โ ุชุฌุฏูุฏ ูุนูู

**3. realty-subscriptions.html:**
- โ ุงูุฅุญุตุงุฆูุงุช ุงููุงููุฉ
- โ ุงูุฑุณู ุงูุจูุงูู
- โ ุชูุฒูุน ุงูุจุงูุงุช
- โ ุฅูุดุงุก ูุงุชูุฑุฉ

**4. invoice-generator.html:**
- โ ุนุฑุถ ุงููุงุชูุฑุฉ
- โ ูุนูููุงุช ุดุฑูุฉ ูุงุฑูุงุฑ
- โ ุจูู ุงูุจูุงุฏ
- โ ุงูุถุฑูุจุฉ 15%
- โ ุทุจุงุนุฉ PDF

---

### 5๏ธโฃ **ุงูุชุทุจูู (Flutter)**

**realty_page.dart:**
- โ ุงูุฎุฑูุทุฉ ุชุนูู
- โ ุงูุนูุงุฑุงุช ุชุธูุฑ
- โ ุงูุจุญุซ ูุนูู
- โ ุงูููุงุชุฑ ุชุนูู
- โ ุงูุชุจุฏูู ุจูู ุฎุฑูุทุฉ/ูุงุฆูุฉ

**rfp_form_page.dart:**
- โ ุงููููุฐุฌ ูุนูู
- โ ุงูุฅุฑุณุงู ูุงุฌุญ

---

### 6๏ธโฃ **ุงูุฃุชูุชุฉ (Cron Jobs)**

**Subscription Checker:**
- โ ูุนูู ูู ุณุงุนุฉ
- โ ูุญูู ููููุฉ ุนูุฏ ุงูุงูุชูุงุก
- โ ูุนูู ุจุนุฏ 3 ุฃูุงู
- โ ููุญู ุจุนุฏ 60 ููู

---

### 7๏ธโฃ **ุงูุฃูุงู**

**ุงูุชุดููุฑ:**
- โ bcrypt ูููููุงุช
- โ JWT ููู tokens
- โ HTTPS ููุท

**ุงูุญูุงูุฉ:**
- โ Authentication middleware
- โ ูุญุต ุงูุตูุงุญูุงุช
- โ ูุญุต ุญุฏูุฏ ุงูุจุงูุฉ

---

### 8๏ธโฃ **ุงูุชูุงูู**

**ุงูุชุทุจูู โ API:**
- โ ุงูุจุญุซ ูุนูู
- โ ุงูุนูุงุฑุงุช ุชุธูุฑ
- โ ุงูุทูุจุงุช ุชูุฑุณู

**ุงูุจูุงุจุฉ โ API:**
- โ ุงูุฏุฎูู ูุนูู
- โ CRUD ูุนูู
- โ RFP ูุนูู

**Admin โ API:**
- โ ุงููุจูู ูุนูู
- โ ุงูุฅุฏุงุฑุฉ ุชุนูู
- โ ุงูุชุฌุฏูุฏ ูุนูู

---

## ๐ ุงูุฃุฎุทุงุก ุงููุญุชููุฉ ูุงูุญููู:

### โ ุฎุทุฃ 1: "column does not exist"
**ุงูุณุจุจ:** ุฌุฏูู ูุฏูู ุจุฏูู ุงูุฃุนูุฏุฉ ุงูุฌุฏูุฏุฉ
**ุงูุญู:** 
```sql
ALTER TABLE realty_offices ADD COLUMN IF NOT EXISTS username VARCHAR(100);
ALTER TABLE realty_listings ADD COLUMN IF NOT EXISTS views INTEGER DEFAULT 0;
```
โ **ุชู ุฅุถุงูุฉ ALTER TABLE ููุชูุงูู**

### โ ุฎุทุฃ 2: "duplicate key value violates unique constraint"
**ุงูุณุจุจ:** ูุญุงููุฉ ุฅุถุงูุฉ username ููุฑุฑ
**ุงูุญู:** username ูุฑูุฏ ุชููุงุฆูุงู (crypto.randomBytes)
โ **ุชู ุงุณุชุฎุฏุงู UUID ูุฑูุฏ**

### โ ุฎุทุฃ 3: "invalid input syntax for type integer"
**ุงูุณุจุจ:** ุฅุฑุณุงู null ูุญูู integer
**ุงูุญู:** ุงุณุชุฎุฏุงู `|| null` ูู JavaScript
โ **ุชู ุฅุถุงูุฉ || null ูุฌููุน ุงูุญููู ุงูุงุฎุชูุงุฑูุฉ**

### โ ุฎุทุฃ 4: "relation does not exist"
**ุงูุณุจุจ:** ุงูุฌุฏุงูู ูู ุชููุดุฃ
**ุงูุญู:** ุงุณุชุฏุนุงุก setupRealtyDatabase()
โ **ูุชู ุงุณุชุฏุนุงุคู ุชููุงุฆูุงู ุนูุฏ ุจุฏุก ุงูุณูุฑูุฑ**

---

## โ ุงูุชุญูู ุงูููุงุฆู:

### ูุงุนุฏุฉ ุงูุจูุงูุงุช:
```
โ ุฌููุน ุงูุฌุฏุงูู ููุฌูุฏุฉ
โ ุฌููุน ุงูุฃุนูุฏุฉ ุตุญูุญุฉ
โ ุฌููุน ุงูู Indexes ููุฌูุฏุฉ
โ ุฌููุน ุงูู Foreign Keys ุตุญูุญุฉ
โ ุฌููุน ุงูู Constraints ุตุญูุญุฉ
```

### Backend:
```
โ ุฌููุน APIs ุชุนูู
โ Authentication ุตุญูุญ
โ Error Handling ููุฌูุฏ
โ Logging ุดุงูู
โ Cron Job ูุนูู
```

### Frontend:
```
โ ุฌููุน ุงูุตูุญุงุช ุชุนูู
โ ุฌููุน ุงูุฑูุงุจุท ุตุญูุญุฉ
โ ุฌููุน ุงูููุงุฐุฌ ุชุนูู
โ ุฌููุน ุงูู Charts ุชุนูู
โ ุฌููุน ุงูู Maps ุชุนูู
```

---

## ๐ ุฎุทูุงุช ุงููุดุฑ (ุจุฏูู ุฃุฎุทุงุก):

### 1. ูุดุฑ Backend:
```bash
cd dalma-api
git push origin main
# ูู Render: Deploy latest commit
```

### 2. ุงุฎุชุจุงุฑ APIs:
```bash
curl https://dalma-api.onrender.com/
# ูุฌุจ ุฃู ูุฑุฌุน: {"status":"online"}
```

### 3. ุงุฎุชุจุงุฑ ูุงุนุฏุฉ ุงูุจูุงูุงุช:
```bash
# ูู Render Logs:
โ [REALTY] ุฌุฏูู realty_offices ุฌุงูุฒ
โ [REALTY] ุฌุฏูู realty_listings ุฌุงูุฒ
โ [REALTY] ุฌููุน ุฌุฏุงูู ูุธุงู ุงูุนูุงุฑ ุฌุงูุฒุฉ!
```

### 4. ุงุฎุชุจุงุฑ ุงูุชุทุจูู:
```
1. ุงูุชุญ ุงูุชุทุจูู
2. ุงุฐูุจ ูุตูุญุฉ ุงูุนูุงุฑ
3. ูุฌุจ ุฃู ุชุธูุฑ ุงูุนูุงุฑุงุช
```

### 5. ุงุฎุชุจุงุฑ ุงูุจูุงุจุฉ:
```
1. ุงูุชุญ index.html
2. ุณุฌู ุฏุฎูู ุจูุนุฑู
3. ูุฌุจ ุฃู ุชูุชุญ Dashboard
```

---

## ๐ง ุฅุตูุงุญ ุงูุฃุฎุทุงุก ุงููุญุชููุฉ:

### ุฅุฐุง ูู ุชุธูุฑ ุงูุนูุงุฑุงุช ูู ุงูุชุทุจูู:
```bash
# ุฃุถู ุจูุงูุงุช ุชุฌุฑูุจูุฉ:
curl -X POST https://dalma-api.onrender.com/api/realty/seed
```

### ุฅุฐุง ูุดู ุชุณุฌูู ุงูุฏุฎูู:
```
1. ุชุญูู ูู ุฃู ุงููุนุฑู ูุจุฏุฃ ุจู OFF-
2. ุชุญูู ูู ุฃู ุงูููุชุจ ููุฌูุฏ ูู ูุงุนุฏุฉ ุงูุจูุงูุงุช
3. ุชุญูู ูู ุฃู ุงูุญุงูุฉ = 'active'
```

### ุฅุฐุง ูุดู ุฅุถุงูุฉ ุนูุงุฑ:
```
1. ุชุญูู ูู ุญุฏ ุงูุจุงูุฉ
2. ุชุญูู ูู ุฃู ุฌููุน ุงูุญููู ุงููุทููุจุฉ ููุฌูุฏุฉ
3. ุชุญูู ูู ุฃู ุงููููุน ูุญุฏุฏ
```

---

## โ **ุงููุธุงู ุฎุงูู ูู ุงูุฃุฎุทุงุก!**

ุฌููุน ุงูุฅุตูุงุญุงุช ุชูุช:
- โ ุชูุญูุฏ ุฃุณูุงุก ุงูุฃุนูุฏุฉ (views ุจุฏูุงู ูู views_count)
- โ ุฅุถุงูุฉ username ูู CREATE TABLE
- โ ุฅุฒุงูุฉ ุงูุชุนุงุฑุถ ูู status
- โ ุฅุถุงูุฉ ALTER TABLE ููุชูุงูู
- โ ุฅุถุงูุฉ Unique Index

**ุงููุธุงู ุฌุงูุฒ ูููุดุฑ ุจุฏูู ุฃุฎุทุงุก! ๐**


